{% extends "base.html" %}
{% from "macros/forms.html" import render_extra_fields %}

{% block content %}
<div class="container">
  <h1 class="container-title">프로필 설정</h1>

  <div class="row">
    <div class="col-md-8">
      {% include "components/errors.html" %}

      {% with form = Forms.self.SettingsForm(language=language, country=country) %}
      <form method="post" accept-charset="utf-8" autocomplete="off" role="form" x-data="SettingsForm"
        @submit.prevent="updateProfile()" class="form-horizontal">

        <div class="mb-3">
          <b>{{ form.name.label(class="form-label") }}</b>
          {{ form.name(class="form-control", value=name) }}
        </div>

        <hr>

        <div class="mb-3">
          <b>{{ form.email.label(class="form-label") }}</b>
          {{ form.email(class="form-control", value=email) }}
        </div>

        <hr>

        <div class="mb-3">
          <b>{{ form.affiliation.label(class="form-label") }}</b>
          {{ form.affiliation(class="form-control", value=affiliation or "", disabled=True) }}
        </div>

        <div class="mb-3">
          <b>{{ form.realname.label(class="form-label") }}</b>
          {{ form.realname(class="form-control", value=realname or "", disabled=True) }}
        </div>

        <div class="mb-3">
          <b><label class="form-label">학번</label></b>
          <div class="row">
            <div class="col px-2 d-flex">
              {{ form.grade(class="form-control w-100", value=grade or "", disabled=True) }}
            </div>
            <div class="col px-2">
              {{ form.classroom(class="form-control w-100", value=classroom or "", disabled=True) }}
            </div>
            <div class="col px-2">
              {{ form.number(class="form-control w-100", value=number or "", disabled=True) }}
            </div>
          </div>
        </div>

        <hr>

        <div class="mb-3">
          <b>{{ form.phone.label(class="form-label") }}</b>
          {{ form.phone(class="form-control", value=phone or "") }}
        </div>

        <div class="mb-3">
          <b>{{ form.birthdate.label(class="form-label") }}</b>
          {{ form.birthdate(class="form-control", value=birthdate or "") }}
        </div>

        <hr>

        <div class="mb-3">
          <b>{{ form.website.label(class="form-label") }}</b>
          {{ form.website(class="form-control", value=website or "") }}
        </div>

        <hr>

        <div class="mb-3">
          <b>{{ form.confirm.label(class="form-label") }}</b>
          {{ form.confirm(class="form-control") }}
        </div>
        <div class="mb-3">
          <b>{{ form.password.label(class="form-label") }}</b>
          {{ form.password(class="form-control") }}
        </div>

        <hr>

        {{ render_extra_fields(form.extra) }}

        <div id="results" class="mb-3">
          <div class="alert alert-success alert-dismissible submit-row" role="alert" x-cloak="success" x-show="success">
            프로필이 성공적으로 업데이트되었습니다.
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
            </button>
          </div>


          <template x-for="(msg, idx) in errors" :key="idx">
            <div class="alert alert-danger alert-dismissible" role="alert">
              <span class="sr-only">{% trans %}Error:{% endtrans %}</span>
              <span x-text="msg"></span>
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
              </button>
            </div>
          </template>
        </div>

        <div class="mb-3">
          {{ form.submit(class="btn btn-primary float-end px-4") }}
        </div>
      </form>
      {% endwith %}
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ Assets.js("assets/js/settings.js") }}
{% endblock %}