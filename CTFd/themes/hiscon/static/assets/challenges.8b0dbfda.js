import{m as n,C as l,h as c,d,M as r}from"./index.57cca434.js";function o(e){let a=new DOMParser().parseFromString(e,"text/html");return a.querySelectorAll('a[href*="://"]').forEach(i=>{i.setAttribute("target","_blank")}),a.documentElement.outerHTML}window.Alpine=n;n.store("challenge",{data:{view:""}});n.data("Hint",()=>({id:null,html:null,async showHint(e){if(e.target.open){let a=(await l.pages.challenge.loadHint(this.id)).data;if(a.content)this.html=o(a.html);else if(await l.pages.challenge.displayUnlock(this.id)){let i=await l.pages.challenge.loadUnlock(this.id);if(i.success){let h=(await l.pages.challenge.loadHint(this.id)).data;this.html=o(h.html)}else e.target.open=!1,l._functions.challenge.displayUnlockError(i)}else e.target.open=!1}}}));n.data("Challenge",()=>({id:null,next_id:null,submission:"",tab:null,solves:[],response:null,async init(){c()},async loadSolves(){this.solves=await l.pages.challenge.loadSolves(this.id),this.solves.forEach(e=>(e.date=d(e.date).format("hh:mm:ss"),e)),this.solves.length||(this.solves=[{account_url:"",date:"",name:"\uC815\uB2F5\uC790 \uC5C6\uC74C"}])},getNextId(){return n.store("challenge").data.next_id},async nextChallenge(){let e=r.getOrCreateInstance("[x-ref='challengeWindow']");e._element.addEventListener("hidden.bs.modal",t=>{n.nextTick(()=>{this.$dispatch("load-challenge",this.getNextId())})},{once:!0}),e.hide()},async submitChallenge(){this.response=await l.pages.challenge.submitChallenge(this.id,this.submission),await this.renderSubmissionResponse()},async renderSubmissionResponse(){this.response.data.status==="correct"&&(this.submission=""),this.$dispatch("load-challenges")}}));n.data("ChallengeBoard",()=>({loaded:!1,challenges:[],challenge:null,async init(){if(this.challenges=await l.pages.challenges.getChallenges(),this.loaded=!0,window.location.hash){let e=decodeURIComponent(window.location.hash.substring(1)),t=e.lastIndexOf("-");if(t>=0){let s=[e.slice(0,t),e.slice(t+1)][1];await this.loadChallenge(s)}}},getCategories(){const e=[];this.challenges.forEach(t=>{const{category:a}=t;e.includes(a)||e.push(a)});try{const t=l.config.themeSettings.challenge_category_order;if(t){const a=new Function(`return (${t})`);e.sort(a())}}catch(t){console.log("Error running challenge_category_order function"),console.log(t)}return e},getChallenges(){let e=this.challenges;try{const t=l.config.themeSettings.challenge_order;if(t){const a=new Function(`return (${t})`);e.sort(a())}}catch(t){console.log("Error running challenge_order function"),console.log(t)}return e=e.map((t,a)=>(t.index=a,t)),e},async loadChallenges(){this.challenges=await l.pages.challenges.getChallenges()},async loadChallenge(e){await l.pages.challenge.displayChallenge(e,t=>{t.data.view=o(t.data.view),n.store("challenge").data=t.data,n.nextTick(()=>{let a=r.getOrCreateInstance("[x-ref='challengeWindow']");a._element.addEventListener("hidden.bs.modal",s=>{history.replaceState(null,null," ")},{once:!0}),a.show(),t.data.type=="docker"&&get_docker_status(t.data.docker_image),history.replaceState(null,null,`#${t.data.name}-${e}`)})})}}));n.start();
